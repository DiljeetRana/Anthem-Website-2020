(function(e,t,n,r){function o(t,n){this.element=t;this.$element=e(this.element);this.options=e.extend({},s,n);this._defaults=s;this._name=i;this.init()}function u(){return t.innerHeight?t.innerHeight:e(t).height()}function a(t){e(t).each(function(){var t=new Image;t.src=this;if(t.width>0)e("<img />").attr("src",this).addClass("litebox-preload").appendTo("body").hide()})}var i="liteBox",s={revealSpeed:400,background:"rgba(0,0,0,.8)",overlayClose:true,escKey:true,navKey:true,callbackInit:function(){},callbackBeforeOpen:function(){},callbackAfterOpen:function(){},callbackBeforeClose:function(){},callbackAfterClose:function(){},callbackError:function(){},callbackPrev:function(){},callbackNext:function(){},errorMessage:"Error loading content."};o.prototype={init:function(){var t=this;this.$element.on("click",function(e){e.preventDefault();t.openLitebox()});keyEsc=27,keyLeft=37,keyRight=39;e("body").off("keyup").on("keyup",function(n){if(t.options.escKey&&n.keyCode==keyEsc)t.closeLitebox();if(t.options.navKey&&n.keyCode==keyLeft)e(".litebox-prev").trigger("click");if(t.options.navKey&&n.keyCode==keyRight)e(".litebox-next").trigger("click")});this.options.callbackInit.call(this)},openLitebox:function(){var t=this;this.options.callbackBeforeOpen.call(this);t.buildLitebox();var n=this.$element;t.populateLitebox(n);if(t.options.overlayClose)$litebox.on("click",function(n){if(n.target===this||e(n.target).hasClass("litebox-container")||e(n.target).hasClass("litebox-error"))t.closeLitebox()});$close.on("click",function(){t.closeLitebox()});if(this.$element.attr("data-litebox-group")){var t=this,r=this.$element.attr("data-litebox-group"),i=e('[data-litebox-group="'+this.$element.attr("data-litebox-group")+'"]');var s=[];e('[data-litebox-group="'+r+'"]').each(function(){var t=e(this).attr("href");s.push(t)});a(s);e(".litebox-nav").show();$prevNav.off("click").on("click",function(){t.options.callbackPrev.call(this);var r=i.index(n);n=i.eq(r-1);if(!e(n).length)n=i.last();t.populateLitebox(n)});$nextNav.off("click").on("click",function(){t.options.callbackNext.call(this);var r=i.index(n);n=i.eq(r+1);if(!e(n).length)n=i.first();t.populateLitebox(n)})}this.options.callbackAfterOpen.call(this)},buildLitebox:function(){var t=this;$litebox=e("<div>",{"class":"litebox-overlay"}),$close=e("<div>",{"class":"litebox-close"}),$error=e('<div class="litebox-error"><span>'+this.options.errorMessage+"</span></div>"),$prevNav=e("<div>",{"class":"litebox-nav litebox-prev"}),$nextNav=e("<div>",{"class":"litebox-nav litebox-next"}),$container=e("<div>",{"class":"litebox-container"}),$loader=e("<div>",{"class":"litebox-loader"});e("body").prepend($litebox.css({"background-color":this.options.background}));$litebox.append($close,$prevNav,$nextNav,$container);$litebox.fadeIn(this.options.revealSpeed)},populateLitebox:function(t){var n=this,r=t.attr("href"),i=e(".litebox-content");$litebox.append($loader);if(r.match(/\.(jpeg|jpg|gif|png|bmp)/i)!==null){var s=e("<img>",{src:r,"class":"litebox-content"});n.transitionContent("image",i,s);e("img.litebox-content").imagesLoaded(function(){$loader.remove()});s.error(function(){n.liteboxError();$loader.remove()})}else if(videoURL=r.match(/(youtube|youtu|vimeo|dailymotion|kickstarter)\.(com|be)\/((watch\?v=([-\w]+))|(video\/([-\w]+))|(projects\/([-\w]+)\/([-\w]+))|([-\w]+))/)){var o="";if(videoURL[1]=="youtube")o="http://www.youtube.com/v/"+videoURL[5];if(videoURL[1]=="youtu")o="http://www.youtube.com/v/"+videoURL[3];if(videoURL[1]=="vimeo")o="http://player.vimeo.com/video/"+videoURL[3];if(videoURL[1]=="dailymotion")o="https://www.dailymotion.com/embed/video/"+videoURL[7];if(videoURL[1]=="kickstarter")o="https://www.kickstarter.com/projects/"+videoURL[9]+"/"+videoURL[10]+"/widget/video.html";if(o){var u=e("<iframe>",{src:o,frameborder:"0",vspace:"0",hspace:"0",scrolling:"no",allowfullscreen:"","class":"litebox-content",style:"background: #000"});n.transitionContent("embed",i,u);u.load(function(){$loader.remove()})}}else if(r.substring(0,1)=="#"){if(e(r).length){$html=e("<div>",{"class":"litebox-content litebox-inline-html"});$html.append(e(r).clone());n.transitionContent("inline",i,$html)}else{n.liteboxError()}$loader.remove()}else{var u=e("<iframe>",{src:r,frameborder:"0",vspace:"0",hspace:"0",scrolling:"auto","class":"litebox-content",allowfullscreen:""});n.transitionContent("iframe",i,u);u.load(function(){$loader.remove()})}},transitionContent:function(n,r,i){var s=this;if(n!="inline")$container.removeClass("litebox-scroll");r.remove();$container.append(i);if(n=="inline")$container.addClass("litebox-scroll");s.centerContent();e(t).on("resize",function(){s.centerContent()})},centerContent:function(){$litebox.css({height:u()});$container.css({"line-height":$container.height()+"px"});if(typeof $html!="undefined"&&e(".litebox-inline-html").outerHeight()<$container.height())e(".litebox-inline-html").css({"margin-top":"-"+e(".litebox-inline-html").outerHeight()/2+"px",top:"50%"})},closeLitebox:function(){this.options.callbackBeforeClose.call(this);$litebox.fadeOut(this.options.revealSpeed,function(){e(".litebox-nav").hide();$litebox.empty().remove();e(".litebox-preload").remove()});e(".litebox-prev").off("click");e(".litebox-next").off("click");this.options.callbackAfterClose.call(this)},liteboxError:function(){this.options.callbackError.call(this);$container.append($error)}};e.fn[i]=function(t){return this.each(function(){if(!e.data(this,i))e.data(this,i,new o(this,t))})}})(jQuery,window,document)